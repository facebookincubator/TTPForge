---
name: paramtest
description: Test variadiac parameter handling
steps:
  - name: "paramtest"
    inline: |
      set -e

      user="$(echo {{user}} | tr -d '\n\t\r')"
      if [[ "{{user}}" == *'{{'* ]]; then
        user=""
      fi

      password="$(echo {{password}} | tr -d '\n\t\r')"
      if [[ "{{password}}" == *'{{'* ]]; then
        password=""
      fi

      token="$(echo {{token}} | tr -d '\n\t\r')"
      if [[ "{{token}}" == *'{{'* ]]; then
        token=""
      fi

      if [[ (-z "$user") || (-z "$password") ]]; then
          echo "Error: Both user and password must have a value."
          exit 1
      fi

      go run delta.go \
        --user $user \
        --password $password \
        --token "$token"
